<div class="categories-pages">
  <div class="breadcrumbs">
    <%= link_to "Categorias", categories_path() %> / <%= link_to @category.name ,category_path(@category) %> / <a class="last-it">Pilotos</a>
  </div>
  <%= link_to("#", class: "fb-share-btn pilots-F-btn", :"data-name" => "Pilotos #{@category.name}",
                                            :"data-caption" => "",
                                            :"data-link" => request.original_url,
                                            :"data-picture" => asset_url(@category.logo.url(:medium)),
                                            :"data-description" => "Lista de los pilotos de #{@category.name}") do %>
      <%= image_tag 'publicarlo-en-fb.png', class: "btn-share", width: 100 %>
    <% end -%>
  <div class="pilots-container">
    <% @pilots.each do |pilot| %>
      <div class="pilot-module">
        <%= link_to pilot_path(@category.id, pilot.id), class: "links-to-pilot" do %>
          <figure class="fig-pilot">
            <%= image_tag pilot.avatar, width: 250  %>
          </figure>
          <div class="data-pilot">
            <h2> <%= pilot.last_name %>,<br> <%= pilot.first_name %> </h2>
            <div class="car-data">
              <span><%= pilot.number %></span>
              <div class="logo">
                <%= image_tag 'logo_vw.png', class: "", width: 40 %>
              </div>
              <div class="team">
                <%= pilot.car %>
              </div>
              <div class="team">
                <%= pilot.team %>
              </div>
              <div class="team">
                <%= pilot.city %>
              </div>
            </div>
          </div>
        <% end -%>
      </div>
    <% end %>
  </div>
</div>

<script type="text/javascript">
    $('.fb-share-btn').on( 'click', function(e) {
    e.preventDefault();
    info = $('.fb-share-btn');
    FB.ui( {
      method: 'feed',
      name: info.data("name"),
      link: info.data("link"),
      picture: info.data("picture"),
      description: info.data("description"),
      caption: info.data("caption")
    },
    function( response ) {
      if ( response !== null && typeof response.post_id !== 'undefined' ) {
        console.log( response );
        // ajax call to save response
        $.post( 'http://www.saltoautomovilclub.herokuapp.com/', { 'meta': response }, function( result ) {
          console.log( result );
        }, 'json' );
      }
    });
  });
</script>